VeRa v0.01 by Twister. Written in 2007 (MASM).

VeRa является достаточно простым (на мой взгляд ;) шифрованным WinNT вирусом. Заражает PE-файлы путем добавления в них новой секции и замены первых исполняемых байт программы на переход к своему "телу". После получения управления вирус расшифровывается, перехватывает некоторые функции для работы с файлами (см. исходник) и перед возвратом управления оригинальной функции пытается заразить целевые файлы. Также перехватывает функцию MessageBox и подменяет выводимый заголовок сообщения на свой. После установки всех перехватов VeRa начинает внедрять свой код во все возможные процессы и запускать его в отдельном потоке (возиться с SetThreadContext было, честно говоря, влом ;). Под конец, когда все вышеописанное уже выполнено, создается поток, который при "удачном стечении обстоятельств" рушит винду - тут я использовал известную дырку, связанную с MessageBoxA. VeRa не заражает повторно уже зараженные файлы и не внедряется в процессы, в которые внедрялась (она ведь женского рода ;) ранее. В коде используется небольшой антитрассировочный трюк, что заставляет эвристические анализаторы "отдыхать". На момент написания этих строк VeRa не детектировалась ни одним доступным мне антивирусом.

Носитель вируса первого поколения представляет из себя консоль для управления VeRa. Запустив этот файл (VeRa.exe) можно выборочно заразить какой-либо PE-файл, внедриться во все возможные процессы (таким образом начав "эпидемию"), найти ранее зараженные файлы в любой указанной директории (поддиректории также сканируются). Планируется также добавить возможность "излечивания" файлов.

http://twister.orgfree.com
twister.kz@mail.ru